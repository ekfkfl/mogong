<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="taskMapper">

<resultMap type="TaskDTO" id="taskMap">
	<id column="task_code" property="taskCode"></id>
	<result column="study_code" property="studyCode"/>
	<result column="progress_status" property="progressStatus"/>
	<result column="start_date" property="startDate"/>
	<result column="end_date" property="endDate"/>
	<result column="success_date" property="successDate"/>
</resultMap>	

<select id="selectAllTask" parameterType="int" resultMap="taskMap">
	select * from task where study_code=#{value}
</select>

<insert id="insertTask" parameterType="TaskDTO">
	insert into task
	values(task_seq.nextval,#{studyCode,jdbcType=VARCHAR},#{title,jdbcType=VARCHAR},#{content,jdbcType=VARCHAR},#{progressStatus},sysdate,sysdate,sysdate)
	<selectKey keyProperty="taskCode" resultType="Integer" order="AFTER">select task_seq.currval from dual</selectKey>
</insert>

<select id="selectOneTask" parameterType="int" resultMap="taskMap">
	select * from task where task_code=#{value}
</select>

<delete id="deleteTask" parameterType="int">
	delete from task where task_code=#{value}
</delete>

<select id="selectTaskMember" parameterType="int" resultType="TaskMemberDTO">
	select member_code as memberCode from task_member where task_code=#{value}
</select>

</mapper>